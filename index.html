<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esc치ner DNI Argentina</title>
    <style>
        #video-container {
            position: relative;
            display: inline-block;
        }
        #recuadro {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300px;
            height: 100px;
            background-color: transparent;
            border: 1px solid white;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body>
    <h2>Escanea el c칩digo de barras del DNI</h2>
    <button id="btnEscanear">Escanear DNI</button>
    <button id="btnLinterna" style="display: none;">游댡 Linterna</button>
    <div id="video-container">
        <video id="video" style="width: 100%; max-width: 400px; display: none;" autoplay></video>
        <div id="recuadro"></div>
    </div>
    <p><strong>Resultado:</strong> <span id="resultado"></span></p>
    <p><strong>Apellido:</strong> <span id="apellido"></span></p>
    <p><strong>Nombre:</strong> <span id="nombre"></span></p>
    <p><strong>DNI:</strong> <span id="dni"></span></p>
    <p><strong>Fecha Emisi칩n:</strong> <span id="fechaEmision"></span></p>

    <script type="module">
        import { BrowserMultiFormatReader } from 'https://cdn.jsdelivr.net/npm/@zxing/library@latest/+esm';

        const codeReader = new BrowserMultiFormatReader();
        const videoElement = document.getElementById("video");
        const resultadoElement = document.getElementById("resultado");
        const btnEscanear = document.getElementById("btnEscanear");
        const btnLinterna = document.getElementById("btnLinterna");

        // Elementos donde se mostrar치n los valores extra칤dos
        const apellidoElement = document.getElementById("apellido");
        const nombreElement = document.getElementById("nombre");
        const dniElement = document.getElementById("dni");
        const fechaEmisionElement = document.getElementById("fechaEmision");

        let stream = null;
        let track = null;
        let linternaEncendida = false;

        btnEscanear.addEventListener("click", () => {
            navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
                .then(s => {
                    stream = s;
                    videoElement.srcObject = stream;
                    videoElement.style.display = "block";
                    videoElement.play();
                    btnLinterna.style.display = "inline"; // Mostrar bot칩n de linterna
                    track = stream.getVideoTracks()[0];

                    codeReader.decodeFromVideoDevice(undefined, videoElement, (result, err) => {
                        if (result) {
                            const datos = result.text;
                            resultadoElement.textContent = datos;

                            // Separar los datos por "@"
                            const partes = datos.split("@");

                            if (partes.length >= 9) {
                                const nroTramite = partes[0];
                                const apellido = partes[1];
                                const nombre = partes[2];
                                const sexo = partes[3];
                                const dni = partes[4];
                                const ejemplar = partes[5];
                                const fechaNacimiento = partes[6];
                                const fechaEmision = partes[7];
                    


